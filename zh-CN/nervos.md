# Nervos Network 简介

Nervos Network 是 Nervos 基金会设计、秘猿科技承接开发的区块链基础设施。它包含 Layer 1 底层公链 Nervos CKB (Common Knowledge Base)、异构跨链组件，以及 Layer 2 的一个官方实现 Nervos AppChain。Nervos Network 诞生的目的是为了解决区块链技术“不可能三角”的难题，即区块链无法同时达到可扩展性（Scalability）、去中心化（Decentralization）、安全（Security），三者只能得其二。

透过 Nervos Network，我们在 Layer 1 强化公有链的安全和去中心化特性，在 Layer 2 提供高性能的执行环境，并通过由 CKB 提供安全保障的异构跨链组件进行跨链资产与信息的交互流转。

## CKB

我们理想中的加密经济网络基础设施，应该是分层和解耦的架构，通过一组协议而不仅仅是一个协议来定义，底层是一个最小化的核心引擎，保障整个网络的安全和秩序。

不同于 Ethereum “全球计算机”和 EOS “区块链操作系统”的目标，CKB 的定位与设计目标即是区块链网络的安全和秩序基础。与性能相比，去中心化和安全是 CKB 更加看重的目标。为此，CKB 采取了如下的设计方案与优化措施：

- 采用 PoW 共识协议并进行深度优化
- 采用 Cell 模型取代账户模型
- 使用 RISC-V 虚拟机指令集

尽管 PoW 共识协议饱受速度缓慢、能耗高和矿池中心化的诟病（或误解），它仍然是被理论和实践证明的最安全的共识协议。PoW 的优势恰恰是使用能耗这个不可逆转的绝对参量，将链外潜在的经济博弈引到链上以弥补链上博弈的不足。考虑 PoS/DPoS 等以持有 Stake 多寡来决定出块权重的共识机制，随着资本的流动，出块权会逐渐向头部固化。而 PoW 机制下，总有更新的工艺或更加愿意投入的人出现，提供更高算力（能耗）以争夺记账权。这是保障 PoW 链安全性和去中心化性的基石。此外，我们针对传统的 PoW 算法做了多项优化。首先，我们采用复杂、全面的算法而不是简单的重复性哈希以确保提供相同算力的前提下，定制化硬件也需要花费与通用硬件相近似的能耗，这样可以使得更多的人参与挖矿并减少矿机厂商的影响。其次，我们修改了区块传播协议，以最大限度地利用带宽。此外，我们还在不显著增加叔伯块分叉的前提下，降低出块时间到几秒这个量级，以提升响应速度并降低矿工对中心化矿池的依赖。

Cell 模型是 CKB 的一个核心创新，它跳出了 Ethereum 以来账户模型的思维定势。账户模型中，世界状态等于历史交易的累计计算结果，而 CKB 在链上则直接存储共识后的最新状态（即 Cell），对交易合法性的验证性计算则放到了链外。具体来说，类似比特币的 UTXO 模式，CKB 上的交易提交人提交的交易数据主要包括交易修改的旧 Cell 列表、交易生成的新 Cell 列表，以及本状态迁移符合的规则。这样做至少有如下的好处。第一，便于交易并发处理提高性能。由于 CKB 上的交易是对旧 Cell 的显式更新，因此 VM 在交易执行之前即明确获知该交易将会影响到的 Cell，于是即可方便地对互不影响的交易进行并行处理。第二，交易确定性。记账节点仅仅是对用户提交的交易进行验证，而非重新计算，因此不符合交易发起人预期的交易不会被确认。第三，轻节点友好，大幅降低节点负担。账户模型下，节点需要对所有交易进行计算方可获得世界状态，这将耗费用户大量的资源。Cell 模型下，用户可以针对自己感兴趣的数据进行交易验证，无需验算每一条数据，这大大降低了节点门槛，同时对轻节点友好。

RISC-V 是一个开源的指令集架构，其特点是小型、快速和低功耗。RISC-V 在工业界有大量的软硬件公司支持，它不仅可以用在标准主机中，也可以通过专用硬件实现。RISC-V 的开发支持也非常全面，具有各种主流语言的虚拟机和编译器实现。

## Layer 2 与 AppChain

Nervos Network 的 Layer 2 泛指基于 CKB 架构的扩展基础设施，包括子链、状态通道甚至中心化服务。开发者可以在 Layer 2 上建构自己的应用，为用户提供高性能的区块链服务。而异构跨链方案则用来确保 Layer 2 和 CKB 以及 Layer 2 之间的资产流动性和互操作性。

Nervos AppChain 是 Layer 2 的一个子链实现。其核心是采用 CITA-BFT 共识协议的区块链 CITA。CITA 可以根据需求配置成联盟链或者公有链，并按需配置经济模型与治理模型。CITA 采用微服务架构，将共识、网络、虚拟机、验签计算等分成不同的微服务采用消息总线链接，这样节点性能不足时可以使用横向扩展方式简单地提升系统吞吐量。CITA 的虚拟机采用 EVM，并支持 solidity、golang 和 rust 语言编写智能合约。

除了区块链之外，AppChain 还为开发者提供了大家区块链生态所需要的全套工具，包括区块浏览器 Microscope、区块数据缓存服务器 ReBirth、移动端钱包与 dApp 容器 Neuron、各个平台的 SDK 以及智能合约开发部署工具和 dApp 调试工具等组件。

AppChain 支持 Nervos 多链协议，该多链协议使得用户可以使用同一个账户地址访问多条 AppChain。 CKB 为多链 AppChain 提供注册与路由，以方便用户访问。

## 异构跨链

Nervos Network 采用异构跨链组件为 Layer 2 提供价值流转与信息交互功能。具体来说，用户主要的业务逻辑发生在 Layer 2 上，采用局部共识保证业务的高性能。考虑到流动性需求和中心化风险，用户有将自己在 Layer 2 上的资产或数据转移到 CKB 或 Layer 2 的另一个基础设施上的需求。

异构跨链组件是由 CKB 通过经济激励机制维护的去中心化的跨链服务。它根据 Layer 2 上用户跨链的需求自发形成一个或多个跨链服务，Layer 2 上的共识机制认可该跨链服务提交的数据，并通过该服务向 CKB 提交跨链请求。一旦该服务的提供者出现作恶或不作为的行为，Layer 2 上的共识机制即可对该服务切换，采用另一组服务提供者提供的跨链服务。

目前 AppChain 将首先支持 CKB 的异构跨链组件，我们也在积极适配其他的 Layer 2 基础设施，以便更多服务可以接入。

## 结论

Nervos Network 为区块链世界提供基础的区块链解决方案，我们希望用户在使用 Nervos 上的 dApp 时对区块链底层尽量无感知。在保障安全和去中心化的前提下，我们希望多链与跨链方案能够自动地解决用户的需求，只有这样，区块链才能尽快地向真实商业普及。